%-----------------------------------------------------------------------------
%  Copyright (C) 2004-2017 Andrew Mathas, University of Sydney
%
%  Distributed under the terms of the GNU General Public License (GPL)
%                  http://www.gnu.org/licenses/
%
% This file is part of the MathQuiz system.
%
% <Andrew.Mathas@sydney.edu.au>
%-----------------------------------------------------------------------------

% common latex code in the documentation files

\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{cmap} % fix search and cut-and-paste in Acrobat
\usepackage{stix}

\usepackage{enumitem}
\setlist[itemize]{nosep}
\setlist[description]{
    font=\sffamily\bfseries\color{DodgerBlue},
    labelwidth=\textwidth
}

\usepackage{graphicx}

\usepackage{xspace}
\usepackage[svgnames]{xcolor}
\def\MathQuiz{{\color{SaddleBrown}\textsc{MathQuiz}}\xspace}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Read the mathquiz.ini file into \pgfkeys for later use so that we
%% don't need to hard-code this information. We allow unknown keys so
%% that we can slurp in all of the information in the file into
%% \pgfkeys{/mathquiz}
\usepackage{pgfkeys}
\pgfkeys{/mathquiz/.is family, /mathquiz,
  % allow arbitrary unknown keys and set with \pgfkeyssetvalue
  .unknown/.code={\pgfkeyssetvalue{\pgfkeyscurrentpath/\pgfkeyscurrentname}{#1}},
}
\newcommand\mathquiz[1]{\pgfkeysvalueof{/mathquiz/#1}}

% split input line into key-value pairs -- necessary as commas can appear in the value
\usepackage{xparse}
% \AddIniFileKeyValue{key=value} - take a single argument and split it on =
\NewDocumentCommand{\AddIniFileKeyValue}{ >{\SplitList{=}} m }{%
  \AddIniFileValue #1%
}
% put a key-value pair into \pgfkeys{/mathquiz}
% \AddIniFile{key}{value}  - note that value may contain commas
\newcommand\AddIniFileValue[2]{\expandafter\pgfkeys\expandafter{/mathquiz,#1={#2}}}

% read the mathquiz.ini file into \pgfkeys{/mathquiz}
\newread\inifile% file handler
\def\apar{\par}% \ifx\par won't work but \ifx\apar will
\newcommand\AddEntry[1]{\expandafter\pgfkeys\expandafter{/mathquiz, #1}}
\openin\inifile=mathquiz.ini% open file for reading
\loop\unless\ifeof\inifile% loop until end of file
  \read\inifile to \iniline% read line from file
  \ifx\iniline\apar% test for, and ignore, \par
  \else%
    \ifx\iniline\empty\relax% skip over empty lines/comments
    \else\expandafter\AddIniFileKeyValue\expandafter{\iniline}
    \fi%
  \fi%
\repeat% end of file reading loop
\closein\inifile% close input file

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% listings code for python and latex examples in mathquiz documentation
\usepackage{listings}
\lstset{%
    % Basic design
    backgroundcolor=\color{LightYellow!50!White},
    basicstyle={\small\ttfamily},
    boxpos=c, % centered
    % frame
    framerule=2pt,
    frame=l,
    framerule=0.5mm,
    rulesep=20mm,
    rulecolor=\color{Peru},
    breaklines=true,
    % colours for keywords etc
    commentstyle=\color{DarkRed},
    keywordstyle=\color{MediumBlue},
    linewidth=14cm,
    basewidth  = {.5em,0.5em},
    numbers=none,
    resetmargins=true,
    tabsize=2,
    xleftmargin=10mm,
    classoffset=1,
    keywordstyle={\color{ForestGreen}},
    % Code design
    keywordstyle=\color{MediumBlue}\bfseries,
    keywordstyle=2{\color{SandyBrown}},
    keywordstyle=3{\color{ForestGreen}},
    commentstyle=\color{BurlyWood}\ttfamily,
    ndkeywordstyle=\color{ForestGreen}\bfseries,
    stringstyle=\color{Coral},
    tabsize=4,
    showtabs=false,
    showspaces=false,
    showstringspaces=false,
}
\lstdefinestyle{latexcode}{
  language=[LaTeX]TeX,
  texcsstyle=*\bfseries\color{DodgerBlue},
  morekeywords={UnitCode,UnitName,UnitURL,QuizzesURL,BreadCrumb,University,Department},
  classoffset=1,
  morekeywords={quiz,quizlist,discussion,question,choice,Choice},
  classoffset=2,
  morekeywords={response,correct,incorrect,whenRight,whenWrong,answer},
}
\lstnewenvironment{latexcode}{\lstset{style=latexcode}}{}

\lstdefinestyle{pythoncode}{
  language=HTML,
  upquote=true,
  classoffset=1,
  morekeywords={quiz_page},
}
\lstnewenvironment{pythoncode}{\lstset{style=pythoncode}}{}

\lstdefinestyle{htmlcode}{
  language=HTML,
  upquote=true,
  morekeywords={no}
  classoffset=1,
  morekeywords={quiz_page, side_menu, quiz_questions, quiz_header, no_script, include, breadcrumbs,},
}
\lstnewenvironment{htmlcode}{\lstset{style=htmlcode}}{}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{tcolorbox}
\newcommand\ScreenShot[2][0.8]{%
  \begin{center}
    \begin{tcolorbox}[colframe=Peru,
                      width=#1\textwidth,
                      boxrule=0.2mm,
                      colback=white,
                      halign=center,
                     ] \includegraphics[width=\textwidth]{#2}
    \end{tcolorbox}
  \end{center}%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\NewDocumentCommand{\Verb}{v}{{\color{blue}#1}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% hyperref settings
\usepackage{hyperref}
\hypersetup{%
    colorlinks=true,
    linkcolor=SaddleBrown,
    urlcolor=Brown,
    pdfauthor   = {\mathquiz{authors}                       },
    pdfkeywords = {\mathquiz{keywords}                      },
    pdfsubject  = {\mathquiz{description}                   },
    pdfinfo     = {%
        copyright    = {\mathquiz{copyright}},
        licence      = {\mathquiz{licence}},
        release date = {\mathquiz{release date}},
        url          = {\mathquiz{url}},
    }
}

\endinput
