%------------------------------------------ -----------------------------------
%  Copyright (C) 2004-2017 Andrew Mathas, University of Sydney
%
%  Distributed under the terms of the GNU General Public License (GPL)
%                  http://www.gnu.org/licenses/
%
% This file is part of the WebQuiz system.
%
% <Andrew.Mathas@sydney.edu.au>
%-----------------------------------------------------------------------------

\synctex=1

\PassOptionsToClass{tikz,svgnames}{xcolor}
\documentclass[svgnames]{article}
\usepackage[a4paper,margin=30mm]{geometry}
\parindent=4mm
\parskip=1mm
\hfuzz 5pt
\synctex=1

\usepackage{textcomp}
\usepackage{pdfpages}
\usepackage{manfnt}
\usepackage{booktabs}

\usepackage{etoolbox}% to patch l@section to remove extraneous spacing
\usepackage{appendix}
\def\sectionautorefname{Chapter}
\def\subsectionautorefname{Section}
\def\subsubsectionautorefname{\S\kern-0.8ex}
\def\appendixautorefname{Appendix}

\usepackage[nonewpage]{imakeidx}
\indexsetup{level=\section*,toclevel=section,noclearpage}
\makeindex[intoc,noautomatic,columns=3]
\indexprologue{\textit{This is an index only for the main \WebQuiz manual. It does not index
the on-line manual.}}

\usepackage{webquiz-doc}

\setcounter{secnumdepth}{3}
\setcounter{tocdepth}{3}
\renewcommand\thesubsubsection{\thesubsection\alph{subsubsection}}
\newcommand\lowerCaseIndex[1]{%
  \lowercase{\def\temp{#1}}%
  \expandafter\index\expandafter{\temp@#1}%
}
% usage: \CrossIndex[*]{main entry}[*]{subentry} with *'s for macros
\NewDocumentCommand\CrossIndex{ smsm }{%
  \IfBooleanTF{#1}{%
    \lowercase{\def\tempa{#2}}%
    \xdef\tempa{\tempa@\noexpand\textbackslash#2}%
  }{\def\tempa{#2}}%
  \IfBooleanTF{#3}{%
    \lowercase{\def\tempb{#4}}%
    \xdef\tempb{\tempb@\noexpand\textbackslash#4}%
  }{\def\tempb{#4}}%
  \expandafter\index\expandafter{\tempa!\tempb}%
  \expandafter\index\expandafter{\tempb}%
}
\newcommand\macroIndex[1]{%
  \lowercase{\def\temp{#1}}%
  \expandafter\index\expandafter{\temp@\textbackslash#1}%
}
\newcommand\gobbleone[1]{}% https://tex.stackexchange.com/questions/318472
\newcommand{\See}[2]{\unskip\emph{see } #1}
\newcommand\SeeIndex[2]{\index{#1!zzzz@\protect\gobbleone|See{#2}}}

\newif\ifCtan\Ctantrue % condition compilation for ctan distribution

\renewcommand*\contentsname{\relax}

% hyperref links to ctan
\NewDocumentCommand\ctan{ O{pkg/#2} m}{%
  \href{https://www.ctan.org/#1}{\texttt{#2}}}
\newcommand\TeXLive{\ctan[/]{\TeX Live}\xspace}
\newcommand\TeXfht{\href{https://www.ctan.org/tex4ht}{TeX4ht}\xspace}

\newcommand\ddash{\texttt{\textemdash\textemdash}}
\newcommand\webquizrc{\index{webquizrc}\textsf{webquizrc}\xspace}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% WebQuiz title box for front page
\usepackage{tikz}
\usetikzlibrary{shadows.blur}

\definecolor{stone}{HTML}{E9E0D8}
\tikzset{shadowed/.style={blur shadow={shadow blur steps=5},
                          top color=stone,
                          bottom color=PapayaWhip,
                          draw=SaddleBrown,
                          shade,
                          font=\normalfont\Huge\bfseries\scshape,
                          rounded corners=8pt,
      },
      boxes/.style={draw=Sienna,
                    fill=Cornsilk,
                    font=\sffamily\small,
                    inner sep=5pt,
                    rectangle,
                    rounded corners=8pt,
                    text=Brown,
     }
}

\def\WebQuizTitle{
  \begin{tikzpicture}[remember picture,overlay]
      \node[yshift=-3cm] at (current page.north west)
        {\begin{tikzpicture}[remember picture, overlay]
          \draw[shadowed](30mm,0) rectangle node[Brown]{WebQuiz} (\paperwidth-30mm,16mm);
          \node[Sienna,font=\normalfont\small\itshape] at (\paperwidth/2,2mm)
          {\small \webquiz{description}};
          \node[anchor=west,boxes] at (4cm,0cm) {\webquiz{name}};
          \node[anchor=east,boxes] at (\paperwidth-4cm,0) {Version \webquiz{version}};
         \end{tikzpicture}
        };
   \end{tikzpicture}
}

\hypersetup{pdftitle={WebQuiz manual}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% headers and footers
\makeatletter
\def\ps@webquiz{
  \ps@empty
  \def\@oddfoot{\tiny\WebQuiz -- \webquiz{version}\hfill%
     \textsc{\ifodd\thepage The WebQuiz manual\else \webquizheader\fi}\hfill\thepage}
}
% hijack section and subsectionmark for our headers
\def\webquizheader{\WebQuiz}
\def\sectionmark#1{\def\webquizheader{#1}}
\def\subsectionmark#1{\def\webquizheader{#1}}
\pagestyle{webquiz}
\patchcmd\l@section{1.0em}{0.5em}{}{}
\makeatother

\begin{document}

    \WebQuizTitle

    \begin{quote}
      \WebQuiz makes it possible to write on-line quizzes using
      \LaTeX, providing an easy way for anyone who knows \LaTeX\ to
      create an on-line quiz using \LaTeX\ file. \WebQuiz allows
      the quiz author to concentrate on the content of quizzes, written
      in \LaTeX, unencumbered by the technicalities of HTML and
      javascript. \WebQuiz was originally developed for writing
      mathematics quizzes, however, the content of the quizzes can
      anything that can be reasonably typeset in \LaTeX.

      \ScreenShot{Example \WebQuiz web page}{examples/quiz-page}

      \begin{center}
        \hfil
        \begin{minipage}{0.7\textwidth}
          \tableofcontents
        \end{minipage}
      \end{center}
    \end{quote}

    \newpage

\section{Introduction}
    On-line quizzes provide a good way to reinforce learning, especially
    because they can give ``interactive'' feedback to the students based
    on the answers that they give. Unfortunately, in addition to writing
    the quiz content there are significant technical hurdles that need
    to be overcome when writing an on-line quiz -- and there are
    additional complications if the quiz involves mathematics or
    diagrams.

    \WebQuiz makes it possible to write on-line quizzes using \LaTeX,
    which is the typesetting language used by mathematicians who use
    \LaTeX\ to write their research papers, books and teaching
    materials. In principle, a \WebQuiz quiz can contain anything that
    can be typeset using \LaTeX.  In practise, the \LaTeX\ is converted
    to HTML using \TeXfht (and
    \href{https://github.com/michal-h21/make4ht}{make4ht}), so the
    quizzes can contain any \LaTeX commands that are understood by \TeX
    4ht, which is almost everything. In particular, it is possible to
    use graphics constructed using packages like \ctan{pstricks} and
    \ctan{tikz}; however, see \autoref{SS:graphics}.

    \WebQuiz supports the following three types of questions:
    \begin{itemize}
      \item Multiple choice questions with a unique correct answer
      \item Multiple choice questions zero or more correct answers
      \item Questions with a numerical answer.
    \end{itemize}
    Each time a student answers a question they are told whether their
    answer is correct and, moreover, it is possible for the quiz author
    to give targeted feedback to the student based on their answer. This
    feed back can be used to explain why the answer is right, why it is
    wrong or to give further hints to the student to help them answer the
    question.

    The on-line quizzes constructed using \WebQuiz can, in principle,
    contain anything that can be typeset by \LaTeX. In particular, they
    do not need to contain mathematics. In fact, the quizzes do not even
    have to contain ``questions'' as it is possible for a \WebQuiz
    ``quiz'' to contain only \textsf{discussion} environments; see
    \autoref{S:documentclass}.

    This introduction outlines how to use \WebQuiz, however, the
    impatient reader may want to skip ahead directly to the
    \autoref{S:documentclass}, where the \LaTeX\ commands used by
    \WebQuiz are described.

    The easiest way to explain how \WebQuiz works is by example. The
    following \LaTeX\ file defines a quiz with a single multiple choice
    question that has four possible answers, each of which has a
    customised response.  (Responses to answers are optional, but they
    are one of the main pedagogical advantages of on-line quizzes
    because the quiz can explain to the student why their answer was
    correct or incorrect.)

    \InputLatexCode{examples/simple}

    Since this is a \LaTeX\ file it can be processed using
    \BashCode{pdflatex}, or \BashCode{latex}, to produce a readable and
    printable version of the quiz, which can be useful when
    proofreading. In this case, the \LaTeX\ version of the quiz looks
    something like this:

    \ScreenShot[0.5]{Sample PDF output}{examples/simple-pdf}

    Of course, the real reason for using \WebQuiz is that it is also
    possible to make an on-line version of the quiz by processing the
    quiz using the \BashCode{webquiz} command. If you do this, and then open
    the resulting web page in your favourite browser, you will see a web page
    that looks something like this:

    \ScreenShot{Sample web page}{examples/simple-html}

    The on-line version of the quiz displays one question at a time,
    with the question buttons serving the dual purpose of navigation
    between questions and displaying how successful the student was
    in answering the question. In fact, the decorations on the question
    buttons indicate whether the question has been attempted and, if so,
    whether it was answered correctly or incorrectly on the first of
    subsequent attempts. One of the main points of \WebQuiz is that
    targeted feedback can be given to the person taking the quiz based
    on their responses.

    The underlying engine used by \WebQuiz is \ctan{tikz} so, because
    \ctan{tikz} is not able process all \LaTeX{} code, it is possible to
    find \LaTeX{} code that \WebQuiz is not able to cope with.
    This said, \WebQuiz has been used to write literally thousands of quiz
    questions without any problems. In particular, it is possible to use
    \ctan[pgf]{tikz} and \ctan{pstricks} in \WebQuiz quizzes, although
    (very?) complicated drawings with these packages may fail; see
    \autoref{SS:graphics}.

\subsection{What WebQuiz does and does not do}

    The \WebQuiz program was designed to be run from the command-line.
    To process the file \texttt{quiz.tex} using \WebQuiz you would
    type

    \BashCode|> webquiz quiz| \qquad or \qquad
    \BashCode|> webquiz quiz.tex|

    \noindent from the command-line. It may be possible to run \WebQuiz
    from inside programs like \TeX Shop by setting the compiler equal to
    \textsf{webquiz}.

    \WebQuiz can be used to ask students a series of ``quiz'' questions. In
    the on-line version of the quiz, the quiz question are displayed one
    at a time. Each question in a quiz, and each quiz itself, can be
    attempted as many times as the student wants: \WebQuiz does not
    limit the number of times that questions can be attempted.
    The following three types of questions are currently supported:
    \begin{itemize}
      \item Multiple choice questions with a unique correct answer
      \item Multiple choice questions zero or more correct answers
      \item Questions with a numerical answer.
    \end{itemize}
    Questions with symbolic answers are not supported.  For example, if
    the answer to a question is~$0$ then $\sin(0)$ will not be accepted
    as a correct answer. Consequently, the only way to ask for the
    indefinite integral of a function is as a multiple choice question.

    The quizzes made using \WebQuiz are intended to be used as a
    revision resource rather than as an assessment tool. Consequently,
    \WebQuiz does not provide a mechanism for recording the marks
    obtained by the students taking the quiz. Technically, it probably
    would not be very hard to record marks but this introduces a
    significant amount of extra overhead in terms of student
    authentication and interfacing with a database. In addition, if
    \WebQuiz were used as an assessment tool then there would be
    additional ``security issues'' to ensure that the quiz content is
    secure. Currently, even though the solutions to the quiz questions
    do not appear in the HTML source code for the quiz it is possible to
    access the answers if you know when you are doing.

    The questions in a \WebQuiz quiz are static. In particular, they do
    not accept variables and exactly the same questions will appear in
    exactly the same order each time the quiz is taken. It would not be
    hard to make the questions appear in a random order. Randomising the
    order of the multiple choice answers would be more be difficult with
    the current implementation.

    The quizzes are not timed and do not have time-limits.

    \WebQuiz supports several different languages and it
    provides a number of different colour schemes (see
    \autoref{SS:commandline} and \autoref{SS:themes}). Any additional
    languages files that are sent to me, as well as corrections to
    existing languages, will be incorporated in future releases.

    Finally, \WebQuiz provides many different new colour schemes (see
    \autoref{SS:commandline} and \autoref{SS:themes}). Again, new colour
    schemes sent to me will be included in future releases, although
    there is a possible complication in that the \WebQuiz CSS files are
    generated using \href{http://sass-lang.com/}{sass}. Part of the
    point of \WebQuiz is to make it possible to write on-line quizzes
    without knowing any HTML, so \WebQuiz provides almost no other
    mechanisms for controlling the style and format of the quizzes that
    it creates (although see \autoref{SS:customisation}).

    Some of the ``missing features'' listed above may be added to \WebQuiz in a future release.

\subsection{Credits}
    \WebQuiz{} was written and developed in the
    \href{http://www.maths.usyd.edu.au/}{School of Mathematics and
    Statistics} at the \href{http://www.usyd.edu.au/}{University of
    Sydney}.  The system is built on \LaTeX{} with the conversion from
    \LaTeX{} to HTML being done by Eitan Gurari's
    \href{http://www.cis.ohio-state.edu/~gurari/TeXfht/mn.html}{TeX4ht}
    and
    \href{https://github.com/michal-h21/make4ht}{make4ht}.

    To write quizzes using \WebQuiz it is only necessary to know
    \LaTeX, however, the underlying \WebQuiz system actually has three components:
    \begin{itemize}
      \item A \href{https://www.latex-project.org/}{\LaTeX} document class file, \texttt{webquiz.cls}, and
      a \ctan[tex4ht]{\TeX 4ht} configuration file, \texttt{webquiz.cfg}, that enable the
      quiz files to be processed by \LaTeX{} and \TeX 4ht, respectively.
      \item A \href{https://www.python.org/}{python} program, \BashCode{webquiz}, that translates the
      \LaTeX{} into xml, using \TeX 4ht, and then into HTML.
      \item \href{https://www.w3schools.com/Js/}{Javascript} and \href{https://www.w3schools.com/css/}{css}
      code that works behind the screens to control and style the quiz web pages.
    \end{itemize}

   The \LaTeX{} component of \WebQuiz{} was written by Andrew Mathas
   and the python, css and javascript code was written by Andrew Mathas
   (and Don Taylor), based on an initial prototype of Don Taylor's from
   2001.  Since 2004 the program has been maintained and developed by
   Andrew Mathas. Although the program has changed substantially since
   2004 some of Don's code, and in particular his idea of using
   \TeXfht, is still in use.

   Thanks are due to Bob Howlett for general help with CSS and to
   Michal Hoftich for invaluable technical advice on \TeXfht.

 \section{The WebQuiz document class --- \LaTeX{} commands}
 \label{S:documentclass}

  This chapter describes the commands and environments provided by the
  \WebQuiz document class. This assumes that you have already installed
  and configured \WebQuiz. If you have not done this yet then you
  should either be brave and type \textsf{webquiz} from the
  command-line, and then follow the prompts to initialise \WebQuiz, or
  follow the more detailed instructions given in
  \autoref{S:configuration}.

  The aim of \WebQuiz is to write on-line quizzes using only \LaTeX.
  This chapter describes the \WebQuiz commands and environments and how
  they put material onto a web page.  All of the code examples given in
  this, and other sections, can be found in the \textsf{examples}
  directory of the \WebQuiz web directory.%
  \footnote{Once \WebQuiz is initialised you can find the \WebQuiz web
  directory using the command:\newline
  \hspace*{10mm}\lstinline[style=bashcode]|webquiz --settings webquiz-www|.}
  More details and some examples can be found in the on-line manual,
  which is included as \autoref{S:online}.

  A typical \WebQuiz quiz file is just a \LaTeX{} file of the form:

    \InputLatexCode{examples/typicalquizfile}

  \noindent You should write your quizzes in the editor that you
  normally use to write \LaTeX. As you write your quiz, you should use
  \BashCode|latex| or \BashCode|pdflatex| to check that your quiz
  compiles and that you are satisfied with the output, just as if you
  were writing a normal \LaTeX{} document.  Once you are satisfied with
  the content of the quiz, say \texttt{quiz.tex}, then you can convert
  it to an on-line quiz using \WebQuiz by typing
  \begin{bashcode}
     > webquiz quiz
  \end{bashcode}
  from the command-line. The quiz file, \textsf{quiz.tex}, should be on
  your web server because \WebQuiz creates a number of different
  files and directories when it converts the file into an on-line quiz.

  The reasons for using this workflow include:
  \begin{itemize}
    \item
    \textit{Every file that you give to \WebQuiz should be a valid \LaTeX{} file!}

    \item The \textsf{dvi} or \textsf{PDF} file produced by \LaTeX{}
    will show all of the information about the questions
    \textit{in an easy-to-read format}. That is, the PDF file will
    display the question, the answers and the feedback that you are
    giving to the students. In contrast, by design, the on-line version
    of the quiz hides most of this information and displays it to the
    student only when they need to see it.

    \item Typesetting the quiz file with \LaTeX{} is \textit{much
    faster} than processing it with \WebQuiz. In fact, \WebQuiz uses
    \textsf{htlatex} to process the quiz file at least \textit{three times} in
    order to produce an \textsf{xml} file and it is only then that the
    \WebQuiz program kicks in to rewrite this data as an \textsf{HTML}
    file.

    \item If \LaTeX{} produces errors then \WebQuiz will produce more
    errors. Further, \textit{\LaTeX{} error messages are much easier to read and
    understand than those produced by \TeXfht and \WebQuiz}.
  \end{itemize}
  Note that the PDF version of a quiz does not contain any
  information about the unit, department or institution. This
  information was included in previous releases of \WebQuiz, however, it
  is now omitted because this data can now be specified in the \webquizrc
  file (see \autoref{SS:rcfile}) and \LaTeX{} does not have access to
  the \webquizrc file.

  The next sections describe the different environments and commands
  provided by \WebQuiz. The last section in this chapter,
  \autoref{SS:graphics}, lists the class options for the \WebQuiz
  document class. You should read this section if you plan to use
  \ctan{pstricks} or \ctan[pgf]{tikz}.

  Finally, if you want to use \WebQuiz for your students then you will
  need to \textit{initialise} \WebQuiz using the command:
  \BashCode|webquiz --initialise|; see \autoref{S:configuration} for more
  details.

\subsection{\WebQuiz environments}

The \WebQuiz document class defines the following four environments:
\begin{quote}
  \begin{description}
    \item[question] Each quiz question needs to be inside
    \LatexCode|question| environment
    \item[choice] For typesetting multiple choice questions, with
    possibly multiple answers
    \item[discussion] For including (optional) discussion, or revision,
    material at the top of the quiz
    \item[quizlist] For writing an index file for the quizzes in
    one ``unit of study''.
  \end{description}
\end{quote}
This section describes these environments and gives examples
of their use.

\subsubsection{Question environments}
\CrossIndex{environment}{question}

Quizzes are composed of questions and each quiz question must to be
placed inside a \LatexCode|question| environment. Typically, a quiz will have
several questions, each wrapped in its own \LatexCode|question| environment.
For brevity, all of the examples in this chapter have only one question
-- see the on-line manual in the \WebQuiz web directory for a complete quiz file.

  \InputLatexCode{examples/answer-integer}
  \macroIndex{answer}\CrossIndex{question environment}*{answer}
  \CrossIndex*{answer}*{whenRight}
  \CrossIndex*{answer}*{whenWrong}
  \index{feedback!whenRight}
  \index{feedback!whenWrong}
  \SeeIndex{numeric answer}{\textbackslash answer}
  This example code shows how to use \LatexCode|\answer|, which is used
  ask for a numerical answer to a question. The  \LatexCode{\answer}
  macro accepts an optional argument for the units for the answer. The
  units are printed on the quiz page after the answer box.

  Then macros
  \LatexCode|\whenRight| and \LatexCode|\whenWrong|, which are mandatory when
  \LatexCode|\answer| is used, are used to give the student feedback, when
  they are right, or further hints etc for approaching the question,
  when they are wrong.

  The web page created by this code-block looks like this:

  \ScreenShot{A question with a numeric answer}{examples/question}

\subsubsection{Choice environments}
\CrossIndex{environment}{choice}
\CrossIndex{question environment}{choice environment}
\SeeIndex{multiple choice}{choice environment}

The multiple choice options for a quiz question need to be placed inside
a \LatexCode|choice| environment. The \LatexCode|choice| environment
accepts two optional arguments, which can appear in any order:
\begin{itemize}
  \item\CrossIndex{choice environment}{single}\CrossIndex{choice environment}{multiple}
  The word \LatexCode|single| (default, and can be omitted) or
  \LatexCode|multiple|, which indicates whether the quiz has a
  \textit{single} correct answer or whether 0 or more of the answers are
  correct, respectively.
  \item \index{choice environment!columns}
  A non-negative integer $n$, specifying that the choices should
  be rendered in $n$ columns.
\end{itemize}
Of course, \LatexCode|choice| environments need to be put inside a
\LatexCode|question| environment.

A \LatexCode|choice| environment  is similar to the list-like environments
(\textit{enumerate}, \textit{itemize}, \textit{description}, ...) except
that rather than using \LatexCode|\item| to separate the different list item
you should use
\LatexCode|\correct| \CrossIndex{choice environment}*{correct}
for correct responses and
\LatexCode|\incorrect| \CrossIndex{choice environment}*{incorrect}
for incorrect responses. In addition, you can use
\LatexCode|\response| \CrossIndex{choice environment}*{response}
to give a feedback response to the person taking the quiz, which is
displayed when they select the last correct or incorrect answer.
\index{feedback!response}

Here is an example of a multiple choice question with a unique answer

  \InputLatexCode{examples/choice-single}

\noindent
It is not necessary to put the \LatexCode|\response| lines on the same line
as the \LatexCode|\(in)correct| lines; this is done here only to make the
example more compact. This results in the following web page:

\ScreenShot{Single answer multiple choice question}{examples/choice-single}

Here is an example of a multiple choice question that has
two correct answers:

  \InputLatexCode{examples/choice-multiple}
  \label{choice-multiple}

  \noindent which gives (here, the documentclass-option
  \LatexCode{theme=vibrant} is used to change the colour scheme):

\ScreenShot{Multi-answer multiple choice question}{examples/choice-multiple}

When the optional argument \LatexCode|multiple| is used, as above, then the
question is marked correct if and only if all of the correct responses
are selected.

  \subsubsection{Discussion environments}
  \CrossIndex{environment}{discussion}

In addition to asking questions it is possible to have revision, or
discussion, material at the \textit{start} of the quiz.  The discussion
items always appear before the quiz questions in the menu down the
left-hand side. It is not possible to interleave discussion items and
questions. Each quiz can have zero or more discussion environments and
these environments can, in principle, contain arbitrary \LaTeX\ code.

For example, running the \LaTeX\ file through \WebQuiz

  \InputLatexCode{examples/discussion}

produces the web page:

\ScreenShot{Web page: discussion environment}{examples/discussion}

As with the questions, only one \LatexCode|discussion| environment is
displayed on the quiz web page at a time. It is possible to have quizzes
that contain only \LatexCode|discussion| environments, with no questions, and
quizzes that contain only \LatexCode|question| environments, with no
discussion.

  \subsubsection{Quiz indexes}

  \index{quizlist environment}
  \CrossIndex{environment}{quizlist}

  Most quizzes occur in sets that cover related material, for example
  for a particular unit of study. The \LatexCode|quizlist| environment can be
  used to create an index page for the quizzes.

  \InputLatexCode{examples/index}

  This code will produce an index web page of the form:

  \ScreenShot{Example index page}{examples/index}

  As the next section describes, index files are also used to
  automatically add a drop-down menu to the breadcrumbs on the quiz web
  pages. This drop-down menu accesses all of the quizzes for the unit.
  As the example above shows, the entries in the \LatexCode|quizlist| are all
  given using the \LatexCode|\quiz| command.\CrossIndex{quizlist
  environment}*{quiz} The syntax for this command is

  \begin{latexcode}
      \quiz|[URL for quiz]{Title for quiz}
  \end{latexcode}

  \noindent
  The \LatexCode|\quiz| macro automatically inserts the quiz numbers
  into the index listing and, by default, it assumes that the URL for the quiz
  is of the form \textsf{quiz1.html}, \textsf{quiz2.html},
  \textsf{quiz3.html}, .... If the URL for the quiz is something
  different this can be given as a optional argument to \LatexCode|\quiz|.

  \subsubsection{Breadcrumbs}\label{SS:breadcrumbs}\index{breadcrumbs}

  \WebQuiz provides a straightforward way to place navigation breadcrumbs
  at the top of the quiz web page. By default these
  breadcrumbs look something like this:

  \ScreenShot{Example of breadcrumbs}{examples/breadcrumbs}

  \noindent
  The breadcrumbs will typically be links, so clicking on the
  \textit{School of Mathematics and Statistics} will take you to the
  School's web page, clicking on \textit{MATH1001} will take you to the
  unit of study web page and clicking on \textit{Quizzes} will take you
  to the index page for the quizzes for the current unit. As alluded to
  in the last section, clicking on the~{\large\color{red} $\equiv$} symbol after
  \textit{Quizzes} causes a drop-down menu to appear that
  contains links to all of the quizzes for the current unit of study.

  \ScreenShot{Drop-down menu giving index of quizzes}{examples/dropdown.png}

  \noindent
  The breadcrumbs for the quiz web page can be either be configured
  quiz-by-quiz, using the \LatexCode|\BreadCrumbs| macro
  \macroIndex{BreadCrumbs}, or by setting \textsf{breadcrumbs}
  ``globally'' in the \webquizrc file using the command-line option
  \begin{bashcode}
    > webquiz --edit-settings|
  \end{bashcode}
  See \autoref{SS:commandline}.

  \noindent
  The breadcrumbs are given as a ``|-separated list''. For example,
  the default breadcrumbs are defined by:

  \begin{latexcode}
    \BreadCrumbs{ department | unitcode | quiz_index | breadcrumb }
  \end{latexcode}

  \noindent
  In fact, the default breadcrumbs are set in the \webquizrc file by
  setting \textsf{breadcrumbs} equal to:
  \begin{latexcode}
     department | unitcode | quiz-index | breadcrumb
  \end{latexcode}
  More generally, the breadcrumbs can be specified as:

  \begin{latexcode}
    \BreadCrumbs{ crumb1 | crumb2 | crumb3 | crumb4 | ...  }
  \end{latexcode}

  \noindent
  In principle, there can be arbitrarily many crumbs in your
  breadcrumbs but, in practice, five is more than enough. Using
  \LatexCode|\BreadCrumbs{none}| will disable the breadcrumbs.
  \CrossIndex*{BreadCrumbs}{none}
  Similarly, setting \textsf{breadcrumbs = none} in the \webquizrc will
  also disable the breadcrumbs, unless there is a \LatexCode|\BreadCrumbs|
  command in the quiz file, which will overwrite the default settings in
  the rc-file.

  The \LatexCode|\BreadCrumbs| command accepts the following ``magic crumbs'':

  \begin{description}
    \item[breadcrumb] The crumb for the current quiz. As described
    below, this is set using \LatexCode|\BreadCrumb|, with the default
    being the quiz title which is set by \LatexCode|\title|
    \CrossIndex*{BreadCrumb}*{title}

    \item[department] This expands to a link to your department, where
    the department is set using \LatexCode|\Department| and its URL is set by
    \LatexCode|\DepartmentURL|
    \macroIndex{Department}\macroIndex{DepartmentURL}

    \item[institution] This expands to a link to your institution, where
    the department is set using \LatexCode|\Institution| and its URL is set by
    \LatexCode|\InstitutionURL|
    \macroIndex{Department}\macroIndex{DepartmentURL}

    \item[quiz-index] This expands to ``Quizzes'', which is a link to
    the index page for your unit as given by \LatexCode|\QuizzesURL|. In
    addition, a drop-down menu to the index page is added to the
    breadcrumbs, which is accessed via {\large\color{red} $\equiv$}.
    \macroIndex{QuizzesURL}

    \item[unitcode] This expands to a link to the unit code, where
    the unit code is set using \LatexCode|\UnitCode|, and its URL is set by
    \LatexCode|\UnitURL|
    \macroIndex{UnitCode}\macroIndex{UnitURL}

    \item[unitname] This expands to a link to the unit name, where
    the unit name is set using \LatexCode|\UnitName|, and its URL is set by
    \LatexCode|\UnitURL|
    \macroIndex{UnitName}\macroIndex{UnitURL}

  \end{description}

  \noindent
  In addition, each \textit{crumb} in a breadcrumb is allowed to be
  arbitrary text, where the last ``word'' is treated as a URL if it
  either beings with a backslash, $\backslash$, or with \texttt{http}.
  For example, rather sparse quiz

  \InputLatexCode{examples/montypython}

  \noindent
  results in the following breadcrumbs:

  \ScreenShot{Guaranteed to offend some one}{examples/montypython}

  If anything used in a breadcrumb is not specified then the crumb name
  together with some question marks will appear on the web page. For
  example, the quiz file
  \InputLatexCode{examples/nounits}
  leads to the breadcrumbs:
  \ScreenShot{Breadcrumbs with no unit name}{examples/nounits}
  This example shows you the breadcrumbs look like when you forget to
  set the data that \WebQuiz needs to construct them.

  In more detail, here is the list of \WebQuiz commands that can be used to
  specify the contents of the breadcrumbs. Some of these can set
  globally in the \webquizrc file.

  \newcommand\Item[1]{\item[\textbackslash#1]\CrossIndex{breadcrumbs}*{#1}}
\begin{description}
  \Item{BreadCrumb}\macroIndex{BreadCrumb}
    The \LatexCode|\BreadCrumb| command sets the \textsf{breadcrumb}
    variable that, by default, is the last item in the breadcrumbs on
    the quiz web page. By default, \textsf{breadcrumb} is as set to be
    the part of the quiz title, as set by \verb!\title!, before the
    first colon. For example, the title

     \hspace*{20mm}\verb!\title{Quiz 1: Some interesting questions about frogs}!

     sets \textsf{breadcrumb} to ``Quiz 1''. Using the \LatexCode|\BreadCrumb|
     command \textit{after} the \LatexCode|\title| command will override the
     value of \textsf{breadcrumb}.

  \Item{Department}\macroIndex{Department}
    The \LatexCode|\Department| command sets the name of the
    \textsf{department}. As described earlier in this section, by
    default, the \textsf{department} is the first item in the
    breadcrumbs that appear at the top of the web page.

    The department can be set globally using
    \BashCode|webquiz --edit-settings|.

    Default value: \textit{Mathematics}

  \Item{DepartmentURL}\macroIndex{DepartmentURL}
    The \LatexCode|\DepartmentURL| command sets URL for the department. As
    described earlier in this section, by default the department URL is
    the link in the first breadcrumb on each web page.

    The department URL can be set globally using \BashCode|webquiz --edit-settings|.

    Default value: \textit{/}

    \Item{Institution}\macroIndex{Institution}
    The \LatexCode|\Institution| command sets the institution, or university.
    The \textsf{institution} appears below the question buttons in the
    left-hand navigation menu that appears on every quiz web page
    (provided that the screen size is not too small).  As described
    earlier in this section, the institution can be used in the web
    page breadcrumbs.

    The institution can be set globally using \BashCode|webquiz --edit-settings|.


    \Item{InstitutionURL}\macroIndex{InstitutionURL}
    The \LatexCode|\InstitutionURL| command sets the institution URL. This is
    used as the link for the \textsf{institution} in the left-hand
    navigation menu that appears on every quiz page.  As described
    earlier in this section, the institution URL can be used in the
    web page breadcrumbs.

    The institution URL can be set globally using \BashCode|webquiz --edit-settings|.

    \Item{QuizzesURL}\macroIndex{QuizzesURL}
    The \LatexCode|\QuizzesURL| command sets the URL for the suite of quizzes
    attached to this unit of study. As described earlier in this
    section, this can be used in the breadcrumb at the top of the quiz
    web page.

    Default:  \texttt{QuizURL/Quizzes}, where \texttt{QuizURL} is set
    using \LatexCode|\QuizURL|

  \Item{UnitCode}\macroIndex{UnitCode}
    The \LatexCode|\UnitCode| command sets the unit of study code for the
    unit that the quiz is attached to. As described earlier in this
    section, this can be used in the breadcrumb at the top of the quiz
    web page.

    \Item{UnitName}\macroIndex{UnitName}
    The \LatexCode|\UnitName| command sets the name of the unit of study for
    the unit that the quiz is attached to. As described earlier in this
    section, this can be used in the breadcrumb at the top of the quiz
    web page.

  \Item{UnitURL}\macroIndex{UnitURL}
    The \LatexCode|\UnitURL| command sets the URL for the unit of study code
    for the unit that the quiz is attached to. As described earlier in
    this section,this can be used in the breadcrumb at the top of the
    quiz web page.

\end{description}

\subsection{WebQuiz class options}
\label{SS:classOptions}

The \textbf{webquiz} document class: supports the following
five document class options:

    \begin{latexcode}
       \documentclass[language=XXX]{webquiz} % set the language

       \documentclass[theme=XXX]{webquiz} % set the theme

       \documentclass[hidesidemenu]{webquiz} % hide the quiz side menu by default

       \documentclass[tikz]{webquiz} % use \ctan{tikz}

       \documentclass[pst2pdf]{webquiz} % automatically apply \ctan{pst2pdf}
    \end{latexcode}

    All other class options that are given to the \WebQuiz document class
    are passed to the \LatexCode{article} class, which is the base class used
    by \BashCode{webquiz}.

    The section describes the three \textit{stylistic} class options:
    \LatexCode|language|, \LatexCode|theme| and \LatexCode|hidesidemenu|.
    Both the \LatexCode|language| and the \LatexCode|theme| can be set globally in
    the \webquizrc; see \autoref{SS:rcfile}.
    The next section discusses the \LatexCode|tikz| and \LatexCode|pst2pdf| class
    options and how to include graphics in a quiz.

\begin{description}
  \item[language=<lang>] \CrossIndex{document class options}{language}
  Set the language used by the \textit{webpages} constructed by \WebQuiz.
  The currently supported languages are:

    \begin{quote}
        \input{webquiz.languages}
    \end{quote}

    The languages files are used to print the various buttons and text
    that is generated on the web pages constructed by \WebQuiz. The
    \textsf{language} option does not affect the DVI or PDF versions of
    the quiz and it does not load language packages like \ctan{babel} or
    \ctan{polyglossia}.

    Typical usage of the \textsf{language} option is the following:
    \lstinputlisting[style=latexcode,extendedchars=false]{examples/french}
    This produces a web page like this:
    \ScreenShot{A web page with \textsf{language=french}}{examples/french}
    As a general rule, \LaTeX{} and \TeXfht do not cope well with
    unicode characters and the page above is one such example.
    Everything displayed inside the quiz will render properly, however,
    information such as the quiz title needs to be processed by
    \BashCode{webquiz} directly and this causes problems. If your quiz
    contains (a lot of) unicode characters then we recommend using
    Xe\LaTeX{} or Lau\LaTeX, which corresponds to using
    \BashCode{webquiz -x} or \BashCode{webquiz -l}, respectively. The
    default \TeX{} engine can be set in the \webquizrc file; see
    \autoref{SS:rcfile}.\index{unicode}\index{lualatex}\index{xelatex}

    The language files were created largely using google translate so
    they may well need fine-tuning\footnote{For example, the word
    ``Copyright'' in lefthand the side-margin is not translated but
    perhaps it should be.}. You can use \BashCode{kpsewhich} to look at
    the language files, which all have names of the form
    \texttt{webquiz-}\textit{language}\texttt{.lang}.  For example, the
    \textit{English} language file, which is the default, can be found
    using the command:
    \begin{bashcode}
         > kpsewhich webquiz-english.lang
    \end{bashcode}
    This file contains the following:
    \InputBashCode{webquiz-english.lang}
    In these files, the material to the left of the equals signs are
    effectively variables, and so they should never be changed, whereas
    anything the right of the equals signs is the text that is written
    to the \WebQuiz web pages. To add \WebQuiz support for a new
    language, say \textsf{XXX}, copy any \WebQuiz language file and
    translate the material to the right of the equals signs and then
    save the file as \texttt{webquiz-XXX.lang}, and then put this file
    anywhere in the \LaTeX{} search path. Note that the expressions
    \LatexCode|({})| in the language files should be not be removed because
    they expand to expressions like \textsf{(a)}, \textsf{(b)} etc. when
    used in the on-line quizzes. Once the new language file
    \texttt{webquiz-XXX.lang} is in the \LaTeX{} search path it can be
    used by \WebQuiz using the \LatexCode|language| document-class
    option:
    \begin{latexcode}
       \documentclass[language=XXX]{webquiz}
       \begin{document}
            insert quiz code
       \end{document}
    \end{latexcode}
    Please submit any new language files, or corrections to existing
    language files, as a \textit{new issue} at:
      \href{https://\webquiz{repository}}{\webquiz{repository}}.

  \item[theme]\CrossIndex{document class options}{theme}

     \WebQuiz\ has a small number of different themes for setting the
     colours on the quiz web pages. The theme can be set as an option to
     the document class or in the \webquizrc file. All of the examples
     so far have used the \LatexCode|default| theme. As
     an example, if we use

    \InputLatexCode{examples/theme-dark}

    then the quiz page looks like:

    \ScreenShot{Multiple choice with light theme}{examples/theme-dark}

    This should be compared with the corresponding screenshot in section
    \autoref{choice-multiple}, which uses the default theme.

    The list of currently supported themes is:

      \begin{quote}
          \input{webquiz.themes}
      \end{quote}

    For screenshots for the complete list of themes see
    \autoref{SS:themes}.

    \item[hidesidemenu]\CrossIndex{document class options}{hide side menu}
    If this option is set the end the side menu is not displayed
    initially.  By default, the side menu appears unless the screen size
    is too small.

    Examples of the \textsf{hidesidemenu} class option have already been
    given above.
\end{description}

\subsection{Including graphics and using pstricks and tikz}\label{SS:graphics}

By far the easiest way to include images when using \WebQuiz is by
adding
\begin{latexcode}
    \usepackage[dvipdfmx]{graphicx}\DeclareGraphicsExtensions{.png}
\end{latexcode}
to your document preamble. You need to use
\LatexCode|\DeclareGraphicsExtensions| to tell \WebQuiz what types of
images you are using, so the code above works for \LatexCode{png}
images. More generally, you can use a comma separated list of
extensions. such as:
\begin{latexcode}
  \DeclareGraphicsExtensions{.png, .jpg, .gif}
\end{latexcode}
The option \LatexCode|dvipdfmx|
to \LatexCode|graphicx| is only necessary if you want to be able to
rescale images. For example, the code:

    \InputLatexCode{examples/using-images}

produces the web page:

\ScreenShot{Including images}{examples/using-images}

Of course, it is also possible to draw quite complicated diagrams in
\LaTeX\ documents using packages like \ctan{tikz} and \ctan{pstricks}.
These packages can be used in \WebQuiz quizzes although,
unfortunately, both of these packages have issues when used with \TeX
4ht. The good news is that \WebQuiz attempts to solve these problems for
you if you use the appropriate document class options.

\begin{description}
    \item[pst2pdf] \index{pstricks}\CrossIndex{document class options}{pst2pdf}

    For the most part \ctan{pstricks} drawings will display correctly
    and when they fail they can often be salvaged by using
    \ctan{pst2pdf}.  \textit{Try the pst3pdf class option if you are
    having trouble displaying an image created using \ctan{pstricks}. It
    is not guaranteed to work but it often fixes the problem}.

    The \LatexCode{pst2pdf} class option automates the
    application of the \LaTeX{} package \ctan{pst2pdf} to a \WebQuiz
    file when converting postscript objects in the quiz into images.
    Whilst not guaranteed to work, this often fixes issues with
    \ctan{pstricks} diagrams. This class option is equivalent to using
    the \ctan|pst2pdf| command-line option; see
    \autoref{SS:commandline}.

    \InputLatexCode{examples/pst2pdf}

    \WebQuiz is unable to create this web page correctly without the
    \ctan|pst2pdf| class option, however, when this option is used
    \WebQuiz constructs the following web page:

    \ScreenShot{Example requiring the pst2pdf document class option}
               {examples/pst2pdf}

    \noindent
    \dbend\quad
    According to the \ctan{pst2pdf} manual:

    \begin{quote}
      \textsf{pst2pdf} needs Ghostscript (>=9.14), perl (>=5.18), pdf2svg, pdftoppm
      and pdftops (from poppler-utils or xpdf-utils) to process a file
      using \ctan{pst2pdf}.
    \end{quote}

    Unfortunately, \textsf{pst2pdf} can fail silently without giving any
    warnings. If using \textsf{pst2pdf} does not produce an image then
    the problem might be that you have not installed all of the programs
    that \textsf{pst2pdf} relies upon, so look in your log files for
    error messages and check the list of programs given above. See
    \autoref{SS:pstricks} for more details.

  \item[tikz]\CrossIndex{document class options}{tikz}
    Giving this class option both loads the \ctan[pgf]{tikz} package (so
    you do not need to have, and should not have,
    \LatexCode|\usepackage{tikz}| in your \LaTeX\ file). As a bonus, this
    \ctan|tikz| document option fixes several issues with PGF that
    prevent it from working with \TeX 4ht. Thanks are due to Michal
    Hoftich for supplying both fixes!\footnote{The first issue is a bug
    that has been reported to the PGF developers, together with a
    one-line solution, but for reasons unknown they have not fixed the
    problem; see
    \href{https://tex.stackexchange.com/questions/386757}{Work around
    for bug in pgf when used with htlatex}.  The second issue is that
    the PGF files hard code \textsf{ISO-8859-1} encoding, which is a
    problem if you use UTF-8; see
    \href{https://tex.stackexchange.com/questions/390421}{Make4ht, tikz
    and UTF 8 encoding question}.  }

    \InputLatexCode{examples/tikz-ex}

    This produces:

    \ScreenShot{Tikz example}{examples/tikz-ex}
\end{description}

Most people use either\ctan{pstricks} or \ctan{tik}. A quiz that tries
to use both \ctan{pstrick} and  \ctan{tik} will probably compile.

\subsection{Configuring commands and environments for \TeXfht}

  \WebQuiz uses \TeXfht{} to convert the quiz content from \LaTeX{} to
  HTML. If \TeXfht{} has not been configured to for some of the commands
  or environments that you are using then they may not display correctly
  in your on-line quizzes. The ``correct'' way to fix such problems is
  to write appropriate \TeXfht{} configuration commands, however, this
  can be tricky to do especially if you are not used to planning around
  with the inner workings of \TeX.

  \WebQuiz provides the command \LatexCode{\Display}, which essentially
  tells \TeXfht to treat your command as an image when it creates the
  web page. This is an easy work-around that is much easier than writing
  your own \TeXfht configuration commands and that usually produces good
  results. For example, the \ctan{mhchem} package is a powerful package
  that defines a macro \LatexCode{\ce} for writing chemical symbols but,
  unfortunately, the \LatexCode{\ce} macro has not (yet) been configured
  to work with \TeXfht, which means that this command will not in
  \WebQuiz quizzes.  Putting the command \LatexCode{\DisplayAsImage{ce}}
  into your preamble fixes this and allows to you to produce quizzes
  using \LatexCode{\ce}. For example, you can produce the quiz

  \ScreenShot{Using DisplayAsImage}{examples/display-as-image}

  using the code:

  \InputLatexCode{examples/display-as-image}

  \noindent
  As the example code shows, \LatexCode{\DisplayAsImage} accepts an optional
  argument that can be used to fine-tune the placement of the image on
  the quiz web page. For those interested in the technical details, the
  definition of \LatexCode{\DisplayAsImage} is

  \begin{latexcode}
    \RequirePackage{etoolbox}
    \renewcommand\DisplayAsImage[2][]{%
      \csletcs{real:#2}{#2}%
      \NewConfigure{#2}{2}
      \csdef{#2}##1{\Picture+[#1]{}\csuse{real:#2}{##1}\EndPicture}
      \Configure{#2}{\Picture+[#1]{}}{\EndPicture}
    }
  \end{latexcode}

\section{System requirements, installation and configuration}
  \label{S:configuration}
  \index{system requirements}
  \CrossIndex{system requirements}{tex4ht}
  \CrossIndex{system requirements}{make4ht}
  \CrossIndex{system requirements}{python}

    \WebQuiz takes a \LaTeX\ file and translates it into a functional
    web page. To use \WebQuiz the quiz author only needs to know how to
    use \LaTeX\ \textit{and} to have all of the programs used by \WebQuiz
    installed. Fortunately, most of the system requirements will already
    be installed on a system with an up-to-date installation of
    \TeXLive, however, some tweaking may still be necessary.

    Behind the scenes, \WebQuiz uses \TeXfht, python, javascript and
    several other tools to construct and operate the on-line quizzes.
    The \WebQuiz program has three main components:
      \begin{itemize}
           \item \LaTeX\ files (a class file and \TeXfht configuration files)
           \item Python3 executables that use \TeXfht to convert \LaTeX\
           files into web pages
           \item Web files (javascript, css and on-line documentation)
          %\item Documentation
      \end{itemize}
    Of course, to use the on-line quizzes created by \WebQuiz you
    need a web server. To use \WebQuiz all of these files need to
    be in appropriate places.  Fortunately, \ctan[/]{ctan} takes care of
    most of this but the web-related files still need to be put onto
    your web server.

    \WebQuiz has been tested extensively on Linux and Mac operating
    systems. Several people have used \WebQuiz on windows computers,
    but I have not tested the program on a windows computer myself.

    \subsection{System requirements}\index{system requirements}

    In order to work \WebQuiz needs the following programs to be
    installed on your system:
    \begin{itemize}
       \item An up-to-date \LaTeX{} distribution, such as that provided
       by \TeXLive. In particular, you need to have \TeXfht{} and
       \ctan{make4ht} installed.

       Unfortunately, the version of \ctan{make4ht} that was released
       with \TeXLive{} 2018 had some bugs and there have been a number of
       additional recent changes to \ctan{make4ht} and \ctan{pstricks},
       so it is strongly recommended that you update all packages from \ctan{}
       before you try and use \WebQuiz.

        \item \href{https://www.python.org/}{Python 3}. As of writing
        python 3.7 is available.
        \item Javascript
        \item If your quizzes use \ctan{pstricks}, or if you want to
        compile the on-line manual, then you need to ensure that
        \href{https://www.ghostscript.com/}{Ghostscript} and
        \ctan{dvisvgm} are installed and properly configured; see
        \autoref{SS:pstricks} for more details.
        \item A web server. As detailed in \autoref{SS:webFiles}, you
        will need to install the web components of \WebQuiz.
    \end{itemize}

    \subsection{Initialising \WebQuiz}\label{SS:webFiles}
    \CrossIndex{command-line options}{initialise}
    \index{installation}\index{initialisation}

    \WebQuiz is a tool for creating on-line quizzes and in order for it
    to work efficiently various files
    (\href{https://en.wikipedia.org/wiki/JavaScript}{javascript} and
     \href{https://www.w3schools.com/css/css_intro.asp}{cascading style
     sheets}) need to put onto your web server. \WebQuiz has an
     \textit{initialisation} routine that helps to streamline
     the process. In fact, until \WebQuiz has been initialised it will
     ask you if you to run the initialisation routine each time you use
     \WebQuiz. You can also initialise at any time using the
     command-line option:
    \begin{bashcode}
      > webquiz --initialise
    \end{bashcode}
    Initialising \WebQuiz will also allow you to set various system
    defaults for the quizzes that, for example, specify the name and URL
    for your department and institution as well as the default language
    and theme used for the quizzes. All of these defaults can be
    overridden in any \LaTeX\ file for a quiz.

    \textit{If you want to install the \WebQuiz files for general use on
    your system, or to save system wide settings, then you need to run the
    initialisation command }\BashCode|webquiz --initialise| \textit{using an
    administrator account or using \textsf{sudo} on a UNIX or Mac OSX
    system.}

    The initialisation routine tries to explain what it is doing at each
    step, and we give more detail below. As \WebQuiz needs to put files
    on your web server, which could be the web server in your school or
    department or the web server on your personal computer, you need to
    initialise \WebQuiz on a computer that has access to the files on
    the web server.

    The location of the files on the web server depend both on the
    operating system that is running on your computer and how your web
    server has been configured. If necessary please consult your system
    administrator. Common locations for the \textit{web root} of the server are:
    \begin{center}
      \begin{tabular}{ll}
        \toprule
        Operating system & Root of web server \\\midrule
        Mac OSX     & \BashCode{/Library/WebServer/Documents}\\
        Linux       & \BashCode{/var/www/html}\\
        Windows     & \BashCode{C:\inetpub\wwwroot}\\
        \bottomrule
      \end{tabular}
    \end{center}
    \WebQuiz needs to copy several files into a subdirectory of this
    \textit{web root}.
    The most important part of the \WebQuiz initialisation is copying
    files into a subdirectory of this web root.


    I recommend running this initialisation command and follow the
    prompts. More detail about what this command does, and what
    information is required, is given for those who want it.

    In fact, it is enough to run \textsf{webquiz} from the command-line
    without any options because it will keep asking you to initialise
    until you do so. \WebQuiz will work without being initialised,
    however, any web pages that are created before initialisation will
    be emblazoned with a message reminding you to initialise \WebQuiz.
    As described in more detail below, initialisation copies the
    javascript and CSS files used by \WebQuiz into the file space used
    by your web server.

    When you run the \WebQuiz initialisation command,
     \BashCode|webquiz --initialise|,  you will be prompted for the following:
     \begin{itemize}
       \item The location of the \WebQuiz web directory, which needs to
       be a directory on your local file system that is visible to your
       web server
       \item The relative URL for this directory, which tells your web
       browser where to find these files
     \end{itemize}
     For example, on my system the base directory for our web server is
     \textsf{/usr/local/httpd/} and the \WebQuiz web
     files are in \textsf{/usr/local/httpd/WebQuiz}. So, I set:
     \begin{quote}
       \begin{tabular}{lll}
         \WebQuiz web directory &=& \textsf{/usr/local/httpd/WebQuiz}\\
         \WebQuiz relative URL  &=& \textsf{/WebQuiz}
       \end{tabular}
     \end{quote}
     In addition, the initialisation command lets you set global defaults for the following:
     \begin{itemize}
       \item breadcrumbs = the breadcrumbs at the top of the quiz web page
       \item department = a (short) name for your department
       \item department-url = the URL for your department's web server
       \item institution = a (short) name for your institution
       \item institution = the URL for your institution
     \end{itemize}
     These settings are mainly used in the \textit{breadcrumbs} on the
     quiz web pages; see \autoref{S:documentclass} for
     details.\index{breadcrumbs}
     If in doubt just press return to accept the default values for
     these variables. You can come back and change these settings at
     any time using the command:
     \begin{bashcode}
        > webquiz --edit-settings
     \end{bashcode}
     In addition, you can override the system defaults in any quiz file.

     Finally, the initialisation command will ask you about some more
     advanced settings. It is very unlikely that you will need to change
     these when you first use \WebQuiz, so I recommend that you hit
     return to accept the default options for each of these settings.

    \bigskip

    \WebQuiz is now ready to use! You can test your \WebQuiz
    installation by compiling the on-line manual, however, please note
    that the on-line manual will compile only if
    \href{https://www.ghostscript.com/}{Ghostscript} and \ctan{dvisvgm}
    are installed and properly configured; see \autoref{SS:graphics} for
    more details.

    \subsection{Pstricks configuration and dvisgm}
    \label{SS:pstricks}

\index{pstricks}
\noindent
Using \ctan{pstricks} is, in some sense, easier that \ctan[pgf]{tikz}
because it seems to work better with \ctan{tex4ht}, however, because of
recent changes in \ctan{tex4ht} and \ctan{pstricks} you should install
the latest updates of both packages.  In addition, because \ctan{tikz}
uses  \ctan{dvisvgm} to convert the images created by \ctan{pstricks},
it is necessary to make sure that this package is correctly
installed. At first sight this looks OK because \ctan{dvisvgm} is
included in \TeXLive and Mik\TeX, however, \ctan{dvisvgm} uses
\href{https://www.ghostscript.com/}{Ghostscript} and this needs to be
correctly configured and, as outlined in
\href{http://dvisvgm.bplaced.net/FAQ}{FAQ}, \ctan{dvisvgm} needs to know
where to find the \href{https://www.ghostscript.com/}{Ghostscript}
libraries. For example, to get \ctan{dvisvgm} to work on my system I
needed to add the line
\begin{bashcode}
  export LIBGS=/usr/local/lib/libgs.dylib
\end{bashcode}
to my \BashCode|.bashrc| file. To see whether you need to do something
similar on your system you nee to look at the output from the following
two commands:

  \begin{bashcode}
    > dvisvgm -h
    > dvisvgm -l
  \end{bashcode}

\noindent There are three possibilities:

  \begin{itemize}
    \item the \BashCode{-h} output does not contain \BashCode{-libgs}
    and the \BashCode{-l} output contains \textsf{ps}:
    ghostscript was linked at build time, so everything should work
    \item
    the \BashCode{-h} output contains \BashCode{-libgs} and the
    \BashCode{-l} output does not contain \textsf{ps}:
    gpostscript support is enabled but ghostscript is not linked. You
    need to locate the ghostscript library
    \BashCode{libgs.so} or \BashCode{libgs.dylib} on your system and set
    the \BashCode{LIBGS} environment variable, or equivalent,
    accordingly
    \item the \BashCode{-h} output does not contain \BashCode{-libgs}
    and the \BashCode{-l} output does not contain \textsf{ps}:
    \ctan{dvisgm} was not built with postscript support. In this
    case, \WebQuiz will not be able to process \ctan{svg} images. You
    need to reinstall \ctan{dvisgm} with ghostscript support.
  \end{itemize}

\section{The WebQuiz program} \index{usage}

    The \WebQuiz program was designed to be run from the command-line,
    so to process the file \textsf{quiz.tex} using \WebQuiz type:

    \BashCode|> webquiz quiz| \qquad or \qquad \BashCode|> webquiz quiz.tex|

    \noindent (Here ``$>$'' is the command-line prompt.) Once useful
    feature of \WebQuiz is that you can ask it to process more than one
    quiz file at a time. For example, if you have quiz files
    \textsf{quiz1.tex}, ..., \textsf{quiz9.tex} in the current directory
    then, on a UNIX system, you can rebuild the web pages for all of
    these quizzes using the single command:

    \BashCode|> webquiz quiz[1-9].tex|

    \noindent
    This is useful if some aspect of all of the quizzes has changed. In
    fact, one would probably use

    \BashCode|> webquiz --qq quiz[1-9].tex|

    \noindent
    because the \BashCode|webquiz --qq| command-line option suppresses
    almost all of the output produced by \LaTeX\ and \TeXfht. The next
    section discusses the \WebQuiz command-line options.

    \subsection{Command-line options}\label{SS:commandline}
    \index{command-line options}

    \InputBashCode{webquiz.usage}

The command-line options are listed on separate lines here to improve
readability but they can appear in any order when you use them provided
that they are all on the same line.  The order that the command-line
options are listed in indicates how often you are likely to need this
option.

    \begin{description}
       \item[-h, --help] \CrossIndex{command-line options}{help}
          list the command-line options and exit

          \textit{You will be given the option of saving the \WebQuiz settings to an rc-file,
          \textsf{.webquizrc}, in your home directory or another file if you do
          not have permission to write to the system rc-file, which is in the
          \WebQuiz scripts directory. }

       \item[-l, \ddash lau] Use lualatex to compile the quiz
       \index{lualatex}

       \item[-s,\ddash shell-escape] \CrossIndex{command-line options}{shell-escape}
       \item[-s,\ddash shell-escape] \CrossIndex{command-line options}{shell-escape}
          Shell escape for htlatex/make4ht

       \item[-q, -qq, \ddash quiet] \CrossIndex{command-line options}{quiet mode}
       Suppress tex4ht messages: \textsf{\ddash q} is quiet and \textsf{\ddash qq} is  very quiet. If you use
       \textsf{webquiz --qq texfile.tex} then almost no output will
       be printed by \WebQuiz when it is processing your quiz file. Be
       warned, however, that both of these options can make it harder to find and fix
       errors, so using the \textsf{\ddash q} and \textsf{\ddash qq} options is not
       recommended if your file is not compiling.

       \item[-x, \ddash xelatex] Use xelatex to compile the quiz
       \index{xelatex}

       \end{description}

        \noindent
       The following options relate to the settings for \WebQuiz:
       \begin{description}

       \item[-i, \ddash initialise] \CrossIndex{command-line options}{initialise}
          Initialise files and settings for webquiz. The command
          \BashCode|webquiz --initialise| should be run before using
          \WebQuiz. This command will help you to copy the web files needed by
          \WebQuiz into the directories used by your web server. See
          \autoref{S:configuration} for more details.

       \item[\ddash edit-settings] \CrossIndex{command-line options}{edit-settings}
          Edit the webquiz settings in the rc-file. The settings that
          are marked as advanced should be changed only with care. To
          change the \textsf{webquiz-www} and \textsf{webquiz-url}
          use: \BashCode|webquiz --initialise|.

       \item[\ddash settings {[SETTING]}] \CrossIndex{command-line options}{settings}
          \SeeIndex{rc file}{webquizrc}
          \SeeIndex{default settings}{webquizrc}
          List system settings for webquiz stored in the  rc-file
          (\textit{run-time configuration file}); see the \textsf{\ddash
          rcfile} command-line option below. Optionally, a single
          \textsf{SETTING} can be given in which case the value of only that
          setting is returned. Typical settings returned by this
          command look like:

          \InputBashCode{webquiz.settings}

          These settings are used by all of the quizzes created by
          \WebQuiz unless the quiz overrides them. These defaults are
          normally set when \WebQuiz is initialised, using the command:
          \BashCode|webquiz --initialise|. The defaults can be changed any time using:
          \BashCode|webquiz --edit-settings|.

       \item[-r RCFILE, \ddash rcfile RCFILE]\index{webquizrc}
          Specify the rc-file (\textit{run-time configuration file}), file
          that \WebQuiz should read (and write to).

          By default, \WebQuiz will first read the system rc-file (the
          file \textsf{webquizrc} in the \WebQuiz script directory),
          followed by the users rc-file in your home directory, which
          will typically be in the home directory but first preference
          will be given to the \BashCode{.dotfiles/config} directory
          if it exists (see \autoref{SS:rcfile}). If \WebQuiz is unable to
          write to the system rc-file then \WebQuiz will create an
          rc-file in your home directory, which it will subsequently
          read whenever you run \WebQuiz. This setting is only
          necessary if you want to override the default rc-file.

          The rc-file can be edited by hand, however, it is
          recommended that you instead use
          \begin{bashcode}
            webquiz --edit-settings
          \end{bashcode}
        \end{description}

        \noindent
        The remaining options are for advanced usage and will not be
        needed by most users:
        \textit{An incorrect value for these settings may stop \WebQuiz from working.}

        \begin{description}
           \item[\ddash make4ht MAKE4HT-OPTIONS]
           \CrossIndex{command-line options}{make4ht}
          Options to be passed to \textsf{make4ht} when converting the
          \LaTeX{} to \textsf{xml}. This option is equivalent to setting
          the \BashCode|make4ht| in the \webquizrc file; see
          \autoref{SS:rcfile}. At least under UNIX, multiple arguments
          should be enclosed in quotes.  For example, to give
          \textsf{make4ht} an mk4 file you would use
          \begin{bashcode}
                    > webquiz --make4ht "-e file.mk4" quiz.tex
          \end{bashcode}
          \WebQuiz provides the command-line options
          \BashCode|--shell-escape|, \BashCode|-lua|, \BashCode|--xelatex|,
          so the \BashCode{make4ht} command-line option will be required
          only in rare instances.
          \index{lualatex}\index{xelatex}

       \item[\ddash webquiz-format WEBQUIZ-FORMAT] \CrossIndex{command-line options}{layout}
          Local python code for formatting the quiz web page. This
          option is equivalent to setting the \textsf{webquiz-format}
          in the \webquizrc file.

    \end{description}

    \subsection{The \webquizrc file}\label{SS:customisation}
    \label{SS:rcfile}\index{default settings}

    \WebQuiz stores various \textit{run-time configuration settings} in
    the \webquizrc file. The system rc-file, \textsf{webquizrc}, is
    saved in the \texttt{scripts/webquiz} subdirectory of the
    \textsf{TEXMFLOCAL} directory. If you are using \TeXLive (and
    possibly Mik\TeX?) you can find this directory using the command
    \begin{bashcode}
            kpsewhich -var-value=TEXMFLOCAL
    \end{bashcode}
    By default, the \WebQuiz settings are saved here so that you do not
    need to reinitialise \WebQuiz whenever you update your \TeX{}
    distribution. If you do not have permission to write to this
    directory then you will be asked if you would like to save the
    rc-file somewhere else.

    Each time \WebQuiz is run it first reads the system rc-file, if it
    exits, followed by the \textit{users rc-file}, which is the file
    \textsf{.webquizrc} in the users home directory -- again, the users
    rc-file is read only if it exists. You can specify an arbitrary file
    as an rc-file using command  \BashCode|webquiz --rc-file|. When you change
    the \WebQuiz settings, using \BashCode|webquiz --edit-settings|, the new
    settings are saved in the last rc-file that was read, which will
    always be the rc-file given by \BashCode|webquiz --rc-file| when this
    command-line option is used.  As with the system rc-file, if you do
    not have permission to write to the specified rc-file then you will
    be asked for a different install location.

    Defaults for many of the generic \WebQuiz settings can be set the
    \webquizrc file. To describe these settings we consider separately
    the ``information settings'', the ``layout settings'' and the
    ``advanced settings'' that most people will not need and should not
    change.

    \subsubsection*{Configuration settings}
    \begin{description}

        \item[webquiz-url] This is the relative URL for webquiz web directory

        \item[webquiz-www] This is the full path to the webquiz web
            directory. The on-line manual and other example code can be
            found in the \texttt{docs} subdirectory. If you use
            \textsf{bash}, then the command
            \begin{bashcode}
                    > cd $(webquiz --settings webquiz-www)/docs
            \end{bashcode}%$
            will take you to the \WebQuiz on-line \texttt{docs/} directory.

    \end{description}

    \subsubsection*{Department settings}
    \begin{description}

        \item[department]
          Sets the default department name; see \LatexCode|\Department| in
          \autoref{SS:breadcrumbs}\macroIndex{Department}

        \item[department-url]
          Sets the URL for the department; see \LatexCode|\DepartmentURL| in
          \autoref{SS:breadcrumbs}\macroIndex{DepartmentURL}

        \item[institution]
          Sets the default institution name. This is overrid see \LatexCode|\Institution| in
          \autoref{SS:breadcrumbs}\macroIndex{Department}

        \item[institution-url]
          Sets the URL for the institution; see \LatexCode|\InstitutionURL| in
          \autoref{SS:breadcrumbs} \macroIndex{InstitutionURL}

      \end{description}

      \subsubsection*{Formatting options}

      \begin{description}

        \item[breadcrumbs]\index{breadcrumbs}
          Sets the default breadcrumbs at the top of quiz page. The
          breadcrumbs can be overwritten in the quiz file using the
          \LatexCode{\BreadCrumbs} command. See \autoref{SS:breadcrumbs}
          for more details.  \macroIndex{BreadCrumbs}

        \item[engine] Sets the default \TeX{} engine to be used when
          compiling the quiz. By default, \BashCode{latex} is used, with
          the two other possibilities being \BashCode{lua} and
          \BashCode{xelatex}. Behind the scenes, the two choices
          correspond to invoking \ctan{make4ht} with the
          \BashCode|--lua| and \BashCode|--xelatex| options,
          respectively. The \BashCode{engine} setting in the  \webquizrc
          file is overridden by the command-line options
          \BashCode{--latex}, \BashCode{--lua} and \BashCode{--xelatex}.
          \index{lualatex}\index{xelatex}

        \item[language]\index{language}
          Sets the default language for the \WebQuiz web pages. This can
          be overridden in the quiz file by using the document class
          \textsf{language} option: \LatexCode|language=XXX|
          See \autoref{SS:classOptions}.

        \item[theme]\index{theme}
          Sets the default colour theme for the \WebQuiz web pages. This can
          be overridden in the quiz file by using the document class
          \textsf{theme} option: \LatexCode|theme=XXX|.
          See \autoref{SS:classOptions}.

      \end{description}

      \subsubsection*{Advanced options}

      \begin{description}

        \item[make4ht]\index{make4ht}
          Options for \textsf{make4ht}. Rather than using \TeXfht
          directly, \WebQuiz uses \textsf{make4ht} to convert the
          \LaTeX\ file to \textsf{xml}. Use this option to
          customise how \textsf{make4ht} is called. See the
          \ctan[make4ht]{make4ht manual} for more information.

        \item[mathjax] \WebQuiz web pages use \href{https://www.mathjax.org/}{mathjax} to
          render the mathematics on the quiz web pages. By default this
          is done by loading \textsf{mathjax} from
          \begin{center}
             \texttt{https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js}
          \end{center}
          Fetching \textsf{mathjax} from an external site can
          cause a delay when the quiz web pages are loaded. This setting
          in the rc-file allows you to change where \textsf{mathjax} is
          loaded from. For example, if you install \textsf{mathjax} on
          your web server then you would replace this will the
          corresponding relative URL.

        \item[webquiz-format]
          Sets the python file that writes the HTML file for the quiz.
          Most people will not need this option. The next subsection
          describes how to do this in more detail.

    \end{description}

    The values of \LatexCode|breadcrumbs|, \LatexCode|department|,
    \LatexCode|department_url|, \LatexCode|institution| and
    \LatexCode|institution_url| can all be overwritten using the
    corresponding  \LaTeX{} commands in the quiz file; see
    \autoref{SS:breadcrumbs} for more details.

    \subsection{Changing the layout of the \WebQuiz web pages} \index{layout}

    \textit{This is an advanced feature that most people will not need.
    To change the layout of the web pages as described below
    requires some knowledge of HTML and python.}

    The construction of the online quizzes is controlled by the python
    file \verb!webquiz_standard.py!. If you want to change the structure
    of the web pages for the quizzes then the easiest way to do this is
    to make a copy of \verb!webquiz_standard.py!, say
    \textsf{webquiz\_myformat.py}, and then edit this file directly.
    This will require working knowledge of python and HTML. To give you
    an idea of what needs to be done, the python file
    \textsf{webquiz\_standard} contains a single function
    \PythonCode|write\_web\_page| that returns the HTML for the page as
    a string using the following:
        \begin{htmlcode}
        quiz_page = r'''<!DOCTYPE HTML>
        <html lang="en">
          <head>
            <title> {title} </title>
            {htmlpreamble}
          </head>

          <body>
            {breadcrumbs}
            {no_script}
            <div class="quiz_page">
              {side_menu}
              <div class="quiz_questions">
                {quiz_header}
                {quiz_questions}
              </div>
            </div>
            {webquiz_init}
          </body>
        </html>
        '''
        \end{htmlcode}
  By changing this output you can change the format of the quizzes
  produced by \WebQuiz. For example, by adding code to the
  \HTMLCode|<head>...</head>| section of \HTMLCode|quiz_page| it is easy to
  include new CSS code and by modifying \HTMLCode|<body>....</body>| you can
  change the ``decorating HTML'' of the web page.  You may also want to
  change the CSS style sheet for webquiz, which is the file
  \textsf{web/webquiz.css}. More sophisticated versions of
  \verb!webquiz_standard.py!  where you change the underlying python
  code are of course possible.  For example, at the University of Sydney
  our version of this python file calls our content management system
  directly and uses this to create the web page for the quiz.

  When experimenting with a new format can run
  \WebQuiz using the command:
  \begin{bashcode}
     > webquiz --webquiz-format webquiz_myformat quizfile.tex
  \end{bashcode}
  Once you have finalised the new format you can make this the default
  format using
  \BashCode|webquiz --edit-settings|.\index{edit-settings}
  \index{webquiz-format}

  If you do make modifications to any of these files it is advisable to
  create a version of the file \textit{with a different name}. This
  will make it easier for you to integrate your changes with any future
  released of \WebQuiz.

  \subsection{Bugs, issues and feature requests}\index{bug reports}
    Please report any bugs, issues or feature requests using the
    \textit{issue} tracker at
    \href{https://\webquiz{repository}}{\webquiz{repository}}.

    When reporting a bug please provide a \textit{minimal working example}
    that clearly demonstrates your problem. This should be a compilable
    \LaTeX file that looks something like the following:
    \begin{latexcode}
       \documentclass{webquiz}
       \begin{document}
            ** insert problematic code here **
       \end{document}
    \end{latexcode}
    Bug reports that do not have a minimal working example are often
    hard to reproduce in which case it is not possible to fix them. Before
    submitting a bug export please check, if possible, to see if
    your problem is really an issue with \TeXfht rather a bug in
    \WebQuiz.

\appendix
\newpage
\section*{Appendices}
  \addcontentsline{toc}{section}{Appendices}
\renewcommand\thesection{}
\renewcommand\thesubsection{\Alph{subsection}}

  \subsection{List of themes}\index{SS:themes}\label{SS:themes}
  \WebQuiz{} comes with quite a few different themes for the on-line
  quizzes, which can be set using the \textsf{theme} documentclass
  option or in the \webquizrc file; see \autoref{SS:classOptions} for
  more details. Themes are easy to construct in principle although
  finding colour that work well together can be tricky in practice.
  Some of the available themes are quite garish, so perhaps the
  different themes should be interpreted as proof-of-concept rather
  than the final product.

  \input webquiz-themes.tex

  I am happy to include any new themes sent to me and to consider
  modifications of existing themes, although there is a potential
  technical issue here in that the underlying \texttt{css} files are
  written using \href{http://sass-lang.com/}{sass}.  Any new themes can
  be sent to me using the \textit{issue} tracker at
    \href{https://\webquiz{repository}}{\webquiz{repository}}.

\subsection{The on-line WebQuiz manual}\label{S:online}

  \WebQuiz has an
  \href{http://www.maths.usyd.edu.au/u/mathas/WebQuiz/webquiz-online-manual.html}{on-line
  manual} that is a \LaTeX file written with the \textsf{webquiz}
  document class. The conversion of the manual from \LaTeX{} to HTML is
  done by \WebQuiz. The PDF version of this manual is included here for
  your convenience. The source file for the on-line manual is included
  in the documentation of \WebQuiz to allow you to create a local
  version of the on-line manual. Look for the file
  \texttt{webquiz-online-manual.tex} in the \textsf{webquiz-www/docs}
  directory; see~\autoref{SS:rcfile}.

  The on-line manual was written for ``internal use'' when \WebQuiz was
  first written in 2004. \WebQuiz has evolved quite a lot since then.
  There is quite a bit of overlap between the on-line manual and
  previous sections, however, the on-line manual only describes how to
  typeset questions and it does not cover some of the more recent
  features of \WebQuiz or how to use the program.  If there are any
  discrepancies between the on-line manual and the earlier sections of
  this manual then the on-line manual should be discounted.

  The on-line manual has diagrams that are drawn using \ctan{pstricks}
  and, as a result, to create a PDF version of the on-line manual use
  \BashCode|latex webquiz-online-manual| to create a \textsf{dvi file}. The
  dvi file can be  converted to PDF using \BashCode|dvipdf|. If you try to
  use \BashCode|pdflatex| directly you will get an error.

  \includepdf[pages=-,pagecommand={\pagestyle{webquiz}}]{webquiz-online-manual}


\subsection{Licence}

Copyright (C) 2013-2017

\href{https://www.gnu.org/licenses/gpl-3.0.en.html}{GNU General Public License, Version 3, 29 June 2007}

This program is free software: you can redistribute it and/or modify it under
the terms of the GNU General Public License (GPL) as published by the Free
Software Foundation, either version 3 of the License, or (at your option) any
later version.

This program is distributed in the hope that it will be useful, but WITHOUT ANY
WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A
PARTICULAR PURPOSE.  See the GNU General Public License for more details.


\vfil
\begin{tabular}{@{}ll}
Authors             & \webquiz{authors}\\
Description         & \webquiz{description}\\
Maintainer          & \webquiz{name}\\
System requirements & \webquiz{requirements}\\
Licence             & \webquiz{licence}\\
Release date        & \webquiz{release date}\\
Repository          & \href{https://\webquiz{repository}}{\webquiz{repository}}
\end{tabular}
\eject

\printindex

\end{document}
